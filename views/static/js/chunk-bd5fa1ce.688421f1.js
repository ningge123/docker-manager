(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-bd5fa1ce"],{"0faa":function(t,n,e){"use strict";e.r(n);var r=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"app-container"},[e("el-cascader",{staticStyle:{width:"500px","margin-right":"10px"},attrs:{disabled:t.isConnected,filterable:"",placeholder:t.$t("目标容器"),clearable:"",options:t.res.containerInfos,props:{expandTrigger:"hover",emitPath:!1}},model:{value:t.form.containerId,callback:function(n){t.$set(t.form,"containerId",n)},expression:"form.containerId"}}),e("el-input",{staticStyle:{width:"160px","margin-right":"10px"},attrs:{placeholder:"请输入内容"},model:{value:t.form.cmd,callback:function(n){t.$set(t.form,"cmd",n)},expression:"form.cmd"}}),e("el-button",{staticClass:"filter-item",attrs:{loading:t.loading,type:"primary",icon:"el-icon-search",disabled:t.isConnected},on:{click:t.onStartExec}},[t._v(" "+t._s(t.$t("连接"))+" ")]),e("el-button",{staticClass:"filter-item",attrs:{loading:t.loading,type:"primary",disabled:!t.isConnected},on:{click:t.onCloseExec}},[t._v(" "+t._s(t.$t("断开连接"))+" ")]),e("div",{staticClass:"console"},[e("terminal",{ref:"terminal",on:{onInitTerm:function(n){t.isConnected=!0},onSocketClose:function(n){t.isConnected=!1},onSocketError:function(n){t.isConnected=!1}}})],1)],1)},o=[],i=e("4dd0"),c=e("ed08"),s=e("b1cf"),a=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"xterm",attrs:{id:"xterm"}})},u=[],d=(e("abb2"),e("fcf3")),l=e("47d0"),f=e("173c"),m=e("408b"),h={name:"Xterm",data:function(){return{isConnected:!1,term:null,socket:null}},mounted:function(){},beforeDestroy:function(){this.close()},methods:{initTerm:function(){var t=new d["Terminal"]({fontSize:14,cursorBlink:!0}),n=new f["AttachAddon"](this.socket),e=new l["FitAddon"],r=new m["WebLinksAddon"];t.loadAddon(n),t.loadAddon(e),t.loadAddon(r),t.open(document.getElementById("xterm")),e.fit(),t.resize(t.cols,t.rows+25),t.focus(),this.term=t,this.isConnected=!0,this.$emit("onInitTerm")},initSocket:function(t){if(""===t)return console.log("Terminal.initSocket.socketURI is empty"),!1;this.socket=new WebSocket(t),this.socketOnClose(),this.socketOnOpen(),this.socketOnError()},close:function(){this.socket&&this.socket.close(),this.term&&this.term.dispose(),this.isConnected=!1},socketOnOpen:function(){var t=this;this.socket.onopen=function(){t.initTerm()}},socketOnClose:function(){var t=this;this.socket.onclose=function(){t.isConnected=!1,t.$emit("onSocketClose")}},socketOnError:function(){var t=this;this.socket.onerror=function(){t.isConnected=!1,t.$emit("onSocketError")}}}},b=h,p=e("2877"),v=Object(p["a"])(b,a,u,!1,null,null,null),g=v.exports,k={name:"ContainerTerminal",components:{Terminal:g},filters:{statusFilter:function(t){var n={published:"success",draft:"gray",deleted:"danger"};return n[t]}},data:function(){return{listLogs:[],loading:!0,isConnected:!1,res:{containerInfos:[]},form:{containerId:"",cmd:"/bin/bash"}}},created:function(){this.fetchData()},destroyed:function(){},methods:{fetchData:function(){var t=this;this.loading=!0,Object(i["c"])().then((function(n){for(var e in t.res.containerInfos=n.data,t.res.containerInfos){var r=t.res.containerInfos[e];for(var o in r.children=r.containers,r.label=r.serverName,r.value=r.serverName,r.children){var i=r.children[o];i.label=i.Name+" - "+i.State,i.value=i.Id,r.children[o]=i}t.res.containerInfos[e]=r}t.loading=!1}))},onStartExec:function(){if(this.form.containerId){var t=Object(c["b"])()+"/dockerMgrApi/ws/exec?containerId="+Object(s["a"])(this.form.containerId)+"&cmd="+this.form.cmd;this.$refs.terminal.initSocket(t)}else this.$message(this.$t("必须选择容器"))},onCloseExec:function(){this.$refs.terminal.close()}}},C=k,I=(e("7767"),Object(p["a"])(C,r,o,!1,null,"6227152e",null));n["default"]=I.exports},"4dd0":function(t,n,e){"use strict";e.d(n,"d",(function(){return o})),e.d(n,"b",(function(){return i})),e.d(n,"c",(function(){return c})),e.d(n,"e",(function(){return s})),e.d(n,"f",(function(){return a})),e.d(n,"a",(function(){return u}));var r=e("b775");function o(t){return Object(r["a"])({url:"/mgr/container/list",method:"get",params:t})}function i(t){return Object(r["a"])({url:"/mgr/container/detail",method:"get",params:t})}function c(t){return Object(r["a"])({url:"/mgr/containerInfos",method:"get",params:t})}function s(t){return Object(r["a"])({url:"/mgr/publish",method:"post",data:t})}function a(t){return Object(r["a"])({url:"/mgr/publish/yaml",method:"post",data:t})}function u(t,n){return Object(r["a"])({url:"/mgr/container/"+t,method:"post",data:n})}},7767:function(t,n,e){"use strict";e("e01c")},b1cf:function(t,n,e){"use strict";e.d(n,"a",(function(){return r})),e.d(n,"d",(function(){return o})),e.d(n,"b",(function(){return i})),e.d(n,"c",(function(){return c})),e.d(n,"e",(function(){return s}));e("b680");function r(t){return t.substr(0,12)}function o(t){if(!t||0===t.length)return"";var n="";for(var e in t){var r=t[e],o=(r.IP?r.IP:"")+(r.PublicPort?":"+r.PublicPort:"");n+=", "+(o?o+"->":"")+r.PrivatePort+"/"+r.Type}return n.substr(1,n.length)}function i(t){return t[0].substr(1,t[0].length-1)}function c(t){if(!t||0===t.length)return"";var n=[];for(var e in t){var r=t[e];n.push(r.Source+" : "+r.Destination)}return n}function s(t){if(!t)return"";var n="";return n=t<1024?t+"B":t<1048576?(t/1024).toFixed(3)+"KB":t<1073741824?(t/1048576).toFixed(3)+"MB":(t/1073741824).toFixed(3)+"GB",n}},e01c:function(t,n,e){}}]);