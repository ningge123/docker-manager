(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4f8d0860"],{aa22:function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){return s}));var r=a("b775");function n(e){return Object(r["a"])({url:"/mgr/server/list",method:"get",params:e})}function i(e){return Object(r["a"])({url:"/mgr/server/names",method:"get",params:e})}function s(e){return Object(r["a"])({url:"/mgr/server/detail",method:"get",params:e})}},b1cf:function(e,t,a){"use strict";a.d(t,"c",(function(){return r})),a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i})),a.d(t,"d",(function(){return s}));a("b680");function r(e){if(!e||0===e.length)return"";var t="";for(var a in e){var r=e[a],n=(r.IP?r.IP:"")+(r.PublicPort?":"+r.PublicPort:"");t+=", "+(n?n+"->":"")+r.PrivatePort+"/"+r.Type}return t.substr(1,t.length)}function n(e){return e[0].substr(1,e[0].length-1)}function i(e){if(!e||0===e.length)return"";var t=[];for(var a in e){var r=e[a];t.push(r.Source+" : "+r.Destination)}return t}function s(e){if(!e)return"";var t="";return t=e<1024?e+"B":e<1048576?(e/1024).toFixed(3)+"KB":e<1073741824?(e/1048576).toFixed(3)+"MB":(e/1073741824).toFixed(3)+"GB",t}},e036:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"filter-container"},[a("el-select",{staticClass:"filter-item",staticStyle:{width:"300px","margin-right":"10px"},attrs:{multiple:"",filterable:"",placeholder:e.$t("服务器"),clearable:"","collapse-tags":""},model:{value:e.listQuery.serverNames,callback:function(t){e.$set(e.listQuery,"serverNames",t)},expression:"listQuery.serverNames"}},e._l(e.res.serverNames,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1),a("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.fetchData}},[e._v(" Search ")])],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"tableList",staticClass:"filter-tree",staticStyle:{"margin-top":"20px"},attrs:{data:e.list.filter((function(t){return!e.search||t.RepoTags.toLowerCase().includes(e.search.toLowerCase())})),"span-method":e.spanMethod,"element-loading-text":"Loading",stripe:"",border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{align:"center",label:"ID",width:"65"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.$index+1)+" ")]}}])}),a("el-table-column",{attrs:{label:"ServerName",width:"170"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.ServerName)+" ")]}}])}),a("el-table-column",{attrs:{label:"ImageId",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.row.ImageId,placement:"top-start"}},[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.openDetail(t.row)}}},[e._v(e._s(e.formatImageId(t.row.ImageId)))])],1)]}}])}),a("el-table-column",{attrs:{label:"Tags",align:"center"},scopedSlots:e._u([{key:"header",fn:function(t){return[e._v(" Tags "),a("el-input",{staticStyle:{width:"140px"},attrs:{size:"mini",placeholder:e.$t("输入关键字过滤")},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})]}},{key:"default",fn:function(t){return e._l(e.formatTags(t.row.RepoTags),(function(t){return a("div",{key:t},[e._v(e._s(t))])}))}}])}),a("el-table-column",{attrs:{label:"Size",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.formatSize(t.row.Size))+" ")]}}])}),a("el-table-column",{attrs:{label:"RepoDigests",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.RepoDigests)+" ")]}}])}),a("el-table-column",{attrs:{align:"center",prop:"created_at",label:"Created",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("i",{staticClass:"el-icon-time"}),a("span",[e._v(e._s(e.formatDate(t.row.Created)))])]}}])}),a("el-table-column",{attrs:{"class-name":"status-col",label:e.$t("操作"),width:"170",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{loading:e.listLoading,type:"text"},on:{click:function(a){return e.ImageOperator("remove",t.row)}}},[e._v(e._s(e.$t("删除")))])]}}])})],1),a("el-pagination",{staticStyle:{width:"500px",margin:"0 auto","margin-top":"10px"},attrs:{"hide-on-single-page":!0,"current-page":e.page.currentPage,"page-sizes":[10,30,50,100,200,300,400],"page-size":e.page.pageSize,layout:"prev, pager, next, jumper, sizes, total",total:e.page.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),a("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.detailLoading,expression:"detailLoading"}],attrs:{visible:e.dialogDetailVisible,title:e.$t("详情")},on:{"update:visible":function(t){e.dialogDetailVisible=t}}},[a("pre",[e._v(e._s(JSON.stringify(e.selectRow,null,2))+"\n      ")])])],1)},n=[],i=(a("d3b7"),a("6062"),a("3ca3"),a("ddb0"),a("d81d"),a("ac1f"),a("1276"),a("aa22")),s=a("b775");function o(e){return Object(s["a"])({url:"/mgr/image/list",method:"get",params:e})}function l(e,t){return Object(s["a"])({url:"/mgr/image/"+e,method:"post",data:t})}function u(e){return console.log("getImage.params:",e),Object(s["a"])({url:"/mgr/image/detail",method:"get",params:e})}var c=a("ed08"),g=a("b1cf"),d={filters:{statusFilter:function(e){var t={published:"success",draft:"gray",deleted:"danger"};return t[e]}},data:function(){return{list:[],page:{currentPage:1,pageSize:10,total:0},groupList:[],groups:{},listLoading:!1,detailLoading:!1,dialogDetailVisible:!1,selectRow:{},res:{serverNames:[]},listQuery:{serverNames:[]},filterText:"",search:""}},computed:{},created:function(){this.fetchData(),this.fetchServerNames()},methods:{ImageOperator:function(e,t){var a=this;this.listLoading=!0;var r={ImageId:t.ImageId,serverName:t.ServerName};l(e,r).then((function(e){"100200"===e.code&&(a.$message({message:a.$t("命令下发成功"),type:"success"}),a.fetchData()),a.listLoading=!1}))},fetchServerNames:function(){var e=this;Object(i["c"])().then((function(t){e.res.serverNames=t.data}))},handleSizeChange:function(e){console.log("每页 ".concat(e," 条")),this.page.pageSize=e,this.fetchData()},handleCurrentChange:function(e){console.log("当前页: ".concat(e)),this.page.currentPage=e,this.fetchData()},fetchData:function(){var e=this;this.listLoading=!0,this.listQuery.currentPage=this.page.currentPage,this.listQuery.pageSize=this.page.pageSize,o(this.listQuery).then((function(t){e.list=t.data.list,e.page=t.data.page,e.list.sort((function(e,t){return e.ServerName.localeCompare(t.ServerName)})),e.groupList=new Set(e.list.map((function(e){return e.ServerName}))),e.groups={};for(var a=0;a<e.list.length;a++){var r=e.list[a],n=e.groups[r.ServerName];n||(n={ServerName:r.ServerName,Members:0,StartIdx:a}),n.Members=n.Members+1,e.groups[r.ServerName]=n}e.listLoading=!1}))},spanMethod:function(e){var t=e.row,a=e.rowIndex,r=e.columnIndex;if(1===r){var n=this.groups[t.ServerName];return a===n.StartIdx?{rowspan:n.Members,colspan:1}:{rowspan:0,colspan:0}}return{rowspan:1,colspan:1}},formatDate:function(e){return Object(c["a"])(e)},FormatName:function(e){return Object(g["a"])(e)},formatSize:function(e){return Object(g["d"])(e)},formatTags:function(e){return e.split(",")},formatImageId:function(e){return e.substr(7,12)},openDetail:function(e){var t=this;this.dialogDetailVisible=!0,this.detailLoading=!0,this.selectRow=e;var a={ImageId:e.ImageId};u(a).then((function(e){t.detailLoading=!1,t.selectRow=e.data,console.log(e.data)}))}}},f=d,p=a("2877"),m=Object(p["a"])(f,r,n,!1,null,null,null);t["default"]=m.exports},ed08:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return s}));var r=a("53ca");a("ac1f"),a("5319"),a("4d63"),a("25f0"),a("d3b7"),a("4d90"),a("a15b"),a("d81d"),a("b64b"),a("1276"),a("159b");function n(e,t){if(0===arguments.length||!e)return null;var a,n=t||"{y}-{m}-{d} {h}:{i}:{s}";"object"===Object(r["a"])(e)?a=e:("string"===typeof e&&(e=/^[0-9]+$/.test(e)?parseInt(e):e.replace(new RegExp(/-/gm),"/")),"number"===typeof e&&10===e.toString().length&&(e*=1e3),a=new Date(e));var i={y:a.getFullYear(),m:a.getMonth()+1,d:a.getDate(),h:a.getHours(),i:a.getMinutes(),s:a.getSeconds(),a:a.getDay()},s=n.replace(/{([ymdhisa])+}/g,(function(e,t){var a=i[t];return"a"===t?["日","一","二","三","四","五","六"][a]:a.toString().padStart(2,"0")}));return s}function i(e,t){e=10===(""+e).length?1e3*parseInt(e):+e;var a=new Date(e),r=Date.now(),i=(r-a)/1e3;return i<30?"刚刚":i<3600?Math.ceil(i/60)+"分钟前":i<86400?Math.ceil(i/3600)+"小时前":i<172800?"1天前":t?n(e,t):a.getMonth()+1+"月"+a.getDate()+"日"+a.getHours()+"时"+a.getMinutes()+"分"}function s(e){if(!e)return"";e=e>0xee09da7916?e:1e3*e;var t=new Date(e),a=t.getFullYear()+"-",r=(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-",n=t.getDate()<10?"0"+t.getDate():t.getDate(),i=(t.getHours()<10?"0"+t.getHours():t.getHours())+":",s=(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":",o=(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())+".",l="";return l=t.getMilliseconds()<10?"00"+t.getMilliseconds():t.getMilliseconds()<100?"0"+t.getMilliseconds():t.getMilliseconds(),a+r+n+" "+i+s+o+l}}}]);