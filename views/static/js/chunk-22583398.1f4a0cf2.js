(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-22583398"],{"4dd0":function(t,e,r){"use strict";r.d(e,"d",(function(){return a})),r.d(e,"b",(function(){return i})),r.d(e,"c",(function(){return o})),r.d(e,"e",(function(){return s})),r.d(e,"f",(function(){return l})),r.d(e,"a",(function(){return u}));var n=r("b775");function a(t){return Object(n["a"])({url:"/mgr/container/list",method:"get",params:t})}function i(t){return Object(n["a"])({url:"/mgr/container/detail",method:"get",params:t})}function o(t){return Object(n["a"])({url:"/mgr/containerInfos",method:"get",params:t})}function s(t){return Object(n["a"])({url:"/mgr/publish",method:"post",data:t})}function l(t){return Object(n["a"])({url:"/mgr/publish/yaml",method:"post",data:t})}function u(t,e){return Object(n["a"])({url:"/mgr/container/"+t,method:"post",data:e})}},a352:function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"app-container"},[r("div",{staticClass:"filter-container"},[r("el-select",{staticClass:"filter-item",staticStyle:{width:"300px"},attrs:{multiple:"",filterable:"",placeholder:t.$t("服务器"),clearable:"","collapse-tags":""},model:{value:t.listQuery.ServerNames,callback:function(e){t.$set(t.listQuery,"ServerNames",e)},expression:"listQuery.ServerNames"}},t._l(t.res.serverNames,(function(t){return r("el-option",{key:t,attrs:{label:t,value:t}})})),1),r("el-select",{staticClass:"filter-item",staticStyle:{width:"300px","margin-left":"10px"},attrs:{multiple:"",filterable:"",placeholder:t.$t("容器名称"),clearable:"","collapse-tags":""},model:{value:t.listQuery.ContainerNames,callback:function(e){t.$set(t.listQuery,"ContainerNames",e)},expression:"listQuery.ContainerNames"}},t._l(t.res.ContainerNames,(function(t){return r("el-option",{key:t,attrs:{label:t,value:t}})})),1),r("el-select",{staticClass:"filter-item",staticStyle:{width:"140px","margin-left":"10px","margin-right":"10px"},attrs:{placeholder:"state",clearable:"",filterable:""},model:{value:t.listQuery.state,callback:function(e){t.$set(t.listQuery,"state",e)},expression:"listQuery.state"}},[r("el-option",{key:"running",attrs:{label:"running",value:"running"}}),r("el-option",{key:"exited",attrs:{label:"exited",value:"exited"}})],1),r("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.fetchData}},[t._v(" Search ")])],1),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],staticStyle:{"margin-top":"20px"},attrs:{data:t.list.filter((function(e){return t.filterMatch(e)})),"span-method":t.spanMethod,"element-loading-text":"Loading",border:"",fit:"","highlight-current-row":""}},[r("el-table-column",{attrs:{align:"center",label:"ID",width:"65"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.$index+1)+" ")]}}])}),r("el-table-column",{attrs:{label:"ServerName",width:"170"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.ServerName)+" ")]}}])}),r("el-table-column",{attrs:{label:"Name"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-button",{attrs:{type:"text",title:e.row.Name},on:{click:function(r){return t.openDetail(e.row)}}},[t._v(t._s(e.row.Name))])]}},{key:"header",fn:function(e){return[t._v(" Name "),r("el-input",{staticStyle:{width:"140px"},attrs:{size:"mini",placeholder:t.$t("输入关键字过滤")},model:{value:t.filterSearch.Name,callback:function(e){t.$set(t.filterSearch,"Name",e)},expression:"filterSearch.Name"}})]}}])}),r("el-table-column",{attrs:{label:"IMAGE",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("span",[t._v(t._s(e.row.Image))])]}}])}),r("el-table-column",{attrs:{label:"Status",width:"200",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.Status)+" ")]}}])}),r("el-table-column",{attrs:{label:"State",width:"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return["running"===e.row.State?r("span",{staticStyle:{color:"#03c961"}},[t._v(t._s(e.row.State))]):t._e(),"running"!==e.row.State?r("span",{staticStyle:{color:"#d70404"}},[t._v(t._s(e.row.State))]):t._e()]}}])}),r("el-table-column",{attrs:{label:"Ports",width:"270",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.Ports,(function(e){return r("div",{key:e.key},[t._v(t._s(t.PortToStr(e)))])}))}}])}),r("el-table-column",{attrs:{align:"center",prop:"created_at",label:"Created",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("i",{staticClass:"el-icon-time"}),r("span",[t._v(t._s(t.formatDate(e.row.Created)))])]}}])}),r("el-table-column",{attrs:{"class-name":"status-col",label:t.$t("操作"),width:"170",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-button",{attrs:{loading:t.listLoading,disabled:"running"!==e.row.State,type:"text"},on:{click:function(r){return t.ContainerOperator("stop",e.row)}}},[t._v(t._s(t.$t("停止")))]),r("el-button",{attrs:{loading:t.listLoading,type:"text"},on:{click:function(r){return t.ContainerOperator("remove",e.row)}}},[t._v(t._s(t.$t("删除")))]),r("el-button",{attrs:{loading:t.listLoading,type:"text"},on:{click:function(r){return t.ContainerOperator("restart",e.row)}}},[t._v(t._s(t.$t("重启")))])]}}])})],1),r("el-dialog",{attrs:{visible:t.dialogDetailVisible,title:t.$t("详情")},on:{"update:visible":function(e){t.dialogDetailVisible=e}}},[r("pre",[t._v(t._s(JSON.stringify(t.selectRow,null,2))+"\n      ")])])],1)},a=[],i=(r("d3b7"),r("6062"),r("3ca3"),r("ddb0"),r("d81d"),r("caad"),r("2532"),r("4dd0")),o=r("aa22"),s=r("ed08"),l=r("b1cf"),u={filters:{statusFilter:function(t){var e={published:"success",draft:"gray",deleted:"danger"};return e[t]}},data:function(){return{list:[],groupList:[],groups:{},listLoading:!1,dialogDetailVisible:!1,selectRow:{},filterSearch:{Name:""},res:{serverNames:[],ContainerNames:[],containerInfos:[]},listQuery:{ServerNames:[],ContainerNames:[],state:void 0}}},computed:{},created:function(){this.fetchData(),this.fetchContainerInfoData(),this.fetchServerNames()},methods:{ContainerOperator:function(t,e){var r=this;this.listLoading=!0;var n={ContainerId:e.ContainerId,ServerNames:[e.ServerName]};Object(i["a"])(t,n).then((function(t){"100200"===t.code?r.$message({message:r.$t("命令下发成功"),type:"success"}):r.$message({message:t.msg,type:"warning"}),r.listLoading=!1}))},fetchServerNames:function(){var t=this;this.listLoading=!0,Object(o["c"])().then((function(e){t.res.serverNames=e.data,t.listLoading=!1}))},fetchContainerInfoData:function(){var t=this;this.loading=!0,Object(i["c"])().then((function(e){var r=e.data;for(var n in t.res.ContainerNames=[],r)for(var a in r[n].containers){var i=r[n].containers[a].Name;-1===t.res.ContainerNames.indexOf(i)&&t.res.ContainerNames.push(i)}t.loading=!1}))},fetchData:function(){var t=this;this.listLoading=!0,Object(i["d"])(this.listQuery).then((function(e){t.list=e.data,t.list.sort((function(t,e){return t.ServerName.localeCompare(e.ServerName)})),t.groupList=new Set(t.list.map((function(t){return t.ServerName}))),t.groups={};for(var r=0;r<t.list.length;r++){var n=t.list[r],a=t.groups[n.ServerName];a||(a={ServerName:n.ServerName,Members:0,StartIdx:r}),a.Members=a.Members+1,t.groups[n.ServerName]=a}t.listLoading=!1}))},spanMethod:function(t){var e=t.row,r=t.rowIndex,n=t.columnIndex;if(1===n){var a=this.groups[e.ServerName];return r===a.StartIdx?{rowspan:a.Members,colspan:1}:{rowspan:0,colspan:0}}return{rowspan:1,colspan:1}},formatDate:function(t){return Object(s["a"])(t)},PortsToStr:function(t){return Object(l["c"])(t)},PortToStr:function(t){var e=(t.IP?t.IP:"")+(t.PublicPort?":"+t.PublicPort:"");return(e?e+" -> ":"")+t.PrivatePort+"/"+t.Type},FormatName:function(t){return Object(l["a"])(t)},openDetail:function(t){var e=this;this.selectRow=t,this.dialogDetailVisible=!0;var r={ContainerId:t.ContainerId};Object(i["b"])(r).then((function(t){e.selectRow=t.data}))},filterMatch:function(t){return!this.filterSearch.Name||t.Name.toLowerCase().includes(this.filterSearch.Name.toLowerCase())}}},c=u,d=r("2877"),f=Object(d["a"])(c,n,a,!1,null,null,null);e["default"]=f.exports},aa22:function(t,e,r){"use strict";r.d(e,"b",(function(){return a})),r.d(e,"c",(function(){return i})),r.d(e,"a",(function(){return o}));var n=r("b775");function a(t){return Object(n["a"])({url:"/mgr/server/list",method:"get",params:t})}function i(t){return Object(n["a"])({url:"/mgr/server/names",method:"get",params:t})}function o(t){return Object(n["a"])({url:"/mgr/server/detail",method:"get",params:t})}},b1cf:function(t,e,r){"use strict";r.d(e,"c",(function(){return n})),r.d(e,"a",(function(){return a})),r.d(e,"b",(function(){return i})),r.d(e,"d",(function(){return o}));r("b680");function n(t){if(!t||0===t.length)return"";var e="";for(var r in t){var n=t[r],a=(n.IP?n.IP:"")+(n.PublicPort?":"+n.PublicPort:"");e+=", "+(a?a+"->":"")+n.PrivatePort+"/"+n.Type}return e.substr(1,e.length)}function a(t){return t[0].substr(1,t[0].length-1)}function i(t){if(!t||0===t.length)return"";var e=[];for(var r in t){var n=t[r];e.push(n.Source+" : "+n.Destination)}return e}function o(t){if(!t)return"";var e="";return e=t<1024?t+"B":t<1048576?(t/1024).toFixed(3)+"KB":t<1073741824?(t/1048576).toFixed(3)+"MB":(t/1073741824).toFixed(3)+"GB",e}},ed08:function(t,e,r){"use strict";r.d(e,"b",(function(){return i})),r.d(e,"a",(function(){return o}));var n=r("53ca");r("ac1f"),r("5319"),r("4d63"),r("25f0"),r("d3b7"),r("4d90"),r("a15b"),r("d81d"),r("b64b"),r("1276"),r("159b");function a(t,e){if(0===arguments.length||!t)return null;var r,a=e||"{y}-{m}-{d} {h}:{i}:{s}";"object"===Object(n["a"])(t)?r=t:("string"===typeof t&&(t=/^[0-9]+$/.test(t)?parseInt(t):t.replace(new RegExp(/-/gm),"/")),"number"===typeof t&&10===t.toString().length&&(t*=1e3),r=new Date(t));var i={y:r.getFullYear(),m:r.getMonth()+1,d:r.getDate(),h:r.getHours(),i:r.getMinutes(),s:r.getSeconds(),a:r.getDay()},o=a.replace(/{([ymdhisa])+}/g,(function(t,e){var r=i[e];return"a"===e?["日","一","二","三","四","五","六"][r]:r.toString().padStart(2,"0")}));return o}function i(t,e){t=10===(""+t).length?1e3*parseInt(t):+t;var r=new Date(t),n=Date.now(),i=(n-r)/1e3;return i<30?"刚刚":i<3600?Math.ceil(i/60)+"分钟前":i<86400?Math.ceil(i/3600)+"小时前":i<172800?"1天前":e?a(t,e):r.getMonth()+1+"月"+r.getDate()+"日"+r.getHours()+"时"+r.getMinutes()+"分"}function o(t){if(!t)return"";t=t>0xee09da7916?t:1e3*t;var e=new Date(t),r=e.getFullYear()+"-",n=(e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"-",a=e.getDate()<10?"0"+e.getDate():e.getDate(),i=(e.getHours()<10?"0"+e.getHours():e.getHours())+":",o=(e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes())+":",s=(e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds())+".",l="";return l=e.getMilliseconds()<10?"00"+e.getMilliseconds():e.getMilliseconds()<100?"0"+e.getMilliseconds():e.getMilliseconds(),r+n+a+" "+i+o+s+l}}}]);